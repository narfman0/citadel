service: citadel-slack-api

provider:
  name: aws
  runtime: nodejs8.10
# TODO update DynamoDB table IAM Role.
#  environment:
#      DYNAMODB_TABLE: ${self:service}-${opt:stage, self:provider.stage}
#    iamRoleStatements:
#      - Effect: Allow
#        Action:
#          - dynamodb:Query
#          - dynamodb:Scan
#          - dynamodb:GetItem
#          - dynamodb:PutItem
#          - dynamodb:UpdateItem
#          - dynamodb:DeleteItem
#        Resource: "arn:aws:dynamodb:${opt:region, self:provider.region}:*:table/${self:provider.environment.DYNAMODB_TABLE}"

functions:
  update:
    handler: status/update.update
    description: Handles a citadel status/update API call from Slack.
    events:
      - http:
        path: status/update
        method: post
        cors: true
    tags:
      Name: "Citadel"
      Owner: "ryan.bruun@cloudreach.com"
      Purpose: "Citadel/Skunkworks"

  get:
      handler: status/get.get
      description: Handles a citadel POST status/get API call from Slack.
      events:
        - http:
          path: status/get
          method: post  # Slack only sends POSTS.
          cors: true
      tags:
        Name: "Citadel"
        Owner: "ryan.bruun@cloudreach.com"
        Purpose: "Citadel/Skunkworks"

